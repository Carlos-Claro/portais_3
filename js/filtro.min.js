
var $=jQuery.noConflict();toastr.options={closeButton:true,debug:false,positionClass:"toast-top-right",onclick:null,showDuration:"500",hideDuration:"500",timeOut:"500",extendedTimeOut:"100",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};$(function(){filtro.inicia();$(".buscar, .mobiliado, .condominio, .quartos, .vagas, .banheiros, .comercial, .residencial").on("click",function(){console.log("buscando");valores=pesquisa.getValores(true);filtro.fechaFiltro()});$(".valor, .area").on("change",function(){console.log("buscando");valores=pesquisa.getValores(true);filtro.fechaFiltro()});$(".limpar").on("click",function(){window.location.href=URL_HTTP});$(".tipo-negocio").on("click",function(){tipo=$(this).attr("data-tipo");setTimeout(function(){pesquisa.getValores(true)},200)});$(document).on("click",".id_empresa",function(){item=$(this).data("item");$(".id_empresa."+item).remove();$(".empresa").remove();$(".banner-imobiliarias").remove();pesquisa.getValores(true,true)});$(document).on("click",".localidade.bairro",function(){item=$(this).data("item");$(".localidade.bairro."+item).remove();pesquisa.getValores(true)});$(document).on("click",".localidade.cidade",function(){item=$(this).data("item");$(".localidade.bairro").remove();$(".localidade.cidade").remove();pesquisa.getValores(true)});$(document).on("click",".tipo",function(){item=$(this).data("item");$(".tipo."+item).remove();pesquisa.getValores(true)});$(".tipos select").on("change",function(){data={id:$(this).find(":selected").val(),text:$(this).find(":selected").html()};item=filtro.setItem(data,"tipo");if(item!==""){filtro.addItem(item,".tipos",false);pesquisa.getValores(true)}});$(".lista-tipo").on("click",function(){$(".lista-tipo").removeClass("active");$(this).addClass("active");pesquisa.getValores(true)});$(".ordem").on("change",function(){pesquisa.getValores(true)});$(".busca-lg").on("click",function(){filtro.setZero()});$(".filtro-atalho").on("click",function(){filtro.abreFiltro()});$(window).scroll(function(f){y=$(this).scrollTop();if(y>20){$(".busca-lg").removeClass("hide")}else{$(".busca-lg").addClass("hide")}if(y>400){if($("body").data("is-mobile")){filtro.fechaFiltro()}}coeficiente=$(".lista-tipo.active").data("tipo")==="lista"?1200:42;y_ver=y%3;if(!y_ver){if(!pesquisa.carregando){qtde=$(".imoveis li.organico").length;ultimo=$(".ultimo").offset().top;if(ultimo>0){if(y>(ultimo-coeficiente)){pesquisa.carregando=true;pesquisa.paginacao();toastr.info("Buscando novos itens: + 12 de "+($(".total").html()-qtde),"Paginando...")}}}}});var d=$(".localidade-select").select2({tags:false,placeholder:"Clique e pesquise a localidade ",amdLanguageBase:"js/i18n/",language:"pt-BR.js",closeOnSelect:true,ajax:{url:function(f){cidade=$(".localidade.cidade").attr("data-item");if(cidade!==undefined&&cidade!==""){bairro_data=$(".localidade.bairro").attr("data-item");bairro=(bairro_data!==undefined)?1:0;return URI+"funcoes/set_bairros_por_cidade_select2/"+cidade+"/"+bairro+""+(f.term===undefined?f.term:"")}else{return URI+"cidades/busca_cidade_json/"+(f.term!==undefined?f.term:"")}},dataType:"json",delay:100,processResults:function(f){return{results:f}}}});d.on("select2:select",function(g){var j=$(".localidade.cidade").data("item");if(j!==undefined&&j!==""){var h=g.params.data.text;var k=g.params.data.id;if(h.indexOf("*")>=0){filtro.setSelectbairro(g.params.data,true)}else{filtro.setSelectbairro(g.params.data,false)}}else{var f=g.params.data.id;if(f.indexOf(";")>0){filtro.setSelectcidade(g.params.data,true)}else{filtro.setSelectcidade(g.params.data,false);$(".localizacao").attr("data-cidade",g.params.data.id)}}});d.on("select2:unselect",function(f){});$(".icon-voltar").on("click",function(f){filtro.abreFiltro()})});var pesquisa={inicia:function(){pesquisa.carregando=true;var d=$(".data-valores").html();pesquisa.data=JSON.parse(d);delete pesquisa.data.tipo_selecionado;delete pesquisa.data.localidade_selecionado;valores=filtro.getElementos();pesquisa.data=valores;filtro.setFiltro();pesquisa.getPesquisa()},paginacao:function(){valores=filtro.getElementos();valores.offset=($(".imoveis li.organico").length)++;total=parseInt($(".qtde .total").html());if(valores.offset>=total){$(".imoveis").append('<li class="nao-encontrei col-lg-12 col-sm-12 col-md-12 col-xs-12"><a href="'+URI+'nao_encontrei"><img src="'+pesquisa.banner_nao_encontrei+'"></a></li>')}else{pesquisa.data=valores;pesquisa.getItens(false);u=document.documentURI;tem_offset=u.indexOf("qtde_itens");tem_i=u.indexOf("?");tem_i_q=u.indexOf("?qtde_itens");if(tem_offset>=0){e=u.split("&qtde_itens=");e.pop();u=e.join("&");ur=u+(tem_i>=0&&tem_i_q<0?"&qtde_itens=":"?qtde_itens=")+$(".imoveis li.organico").length}else{ur=u+(tem_i>=0&&tem_i_q<0?"&qtde_itens=":"?qtde_itens=")+$(".imoveis li.organico").length}setTimeout(function(){document.documentURI=ur;window.history.pushState(undefined,undefined,ur)},700)}},data:{},qtde:0,scroll:0,carregando:false,urlPesquisa:URI+"pesquisa",urlImoveis:URI+"get_itens",getPesquisa:function(f,d){if(d===undefined){d=false}$.post(pesquisa.urlPesquisa,pesquisa.data,function(g){$("h1.titulo").html(g.titulo);$(".qtde").html('<span class="total">'+g.total+"</span> Imóveis encontrados");if(f){if(navigator.userAgent.toLowerCase().indexOf("safari")>=0&&navigator.userAgent.toLowerCase().indexOf("chrome")<0){window.location.href=URI+g.url}else{if(d){document.documentURI=URI+g.url;window.history.pushState(g.titulo,g.titulo,URI+g.url)}else{document.documentURI=g.url;window.history.pushState(g.titulo,g.titulo,g.url)}}}window.title=g.titulo;document.title=g.titulo;$(".imoveis").html("");if(g.total>0&&parseInt($(".imoveis li.imovel").length)<=g.total){pesquisa.getItens(true)}else{$(".imoveis").html('<li class="nao-encontrei col-lg-12 col-sm-12 col-md-12 col-xs-12"><a href="'+URI+'nao_encontrei"><img src="'+pesquisa.banner_nao_encontrei+'"></a></li>');toastr.info("Nenhum imóvel carregado para esta busca.","Sem imóveis...")}pesquisa.carregando=false},"json")},banner_nao_encontrei:URI+"images/banner/nao-encontrei.jpg",getItens:function(d){pesquisa.carregando=true;$.post(pesquisa.urlImoveis,pesquisa.data,function(j){console.log(j.status);console.log($(".imoveis"));if(d){try{$(".imoveis").html(j.data);$(".imoveis").append('<li class="ultimo col-lg-12 col-sm-12 col-md-12 col-xs-12"></li>');toastr.info("12 Imóveis carregados de "+$(".total").html(),"Buscando...")}catch(h){alert(h)}}else{var f=$(".imoveis").data("lista-tipo");$(".imoveis .ultimo").addClass("pagina btn-azul-pow").removeClass("ultimo").html("<center>"+($(".imoveis li.imovel").length)+" Imóveis</center>");try{t=j.data+'"';$(".imoveis").append(t)}catch(g){console.log(g)}try{$(".imoveis").append('<li class="ultimo col-lg-12 col-sm-12 col-md-12 col-xs-12"></li>')}catch(h){console.log(h)}toastr.info($(".imoveis li.imovel").length+" Imóveis carregados de "+$(".total").html(),"Carga concluída...");estatistica.set()}setTimeout(function(){fotos.inicia();pesquisa.carregando=false},500)},"json")},getValores:function(f,d){if(f===undefined){f=true}if(d===undefined){d=false}valores=filtro.getElementos();pesquisa.data=valores;pesquisa.getPesquisa(f,d)}};var filtro={inicia:function(){var f=$(".data-valores").html();var d=JSON.parse(f);this.setElementos(d);this.setTipo();this.setLocalidade();filtro.setFiltro()},setFiltro:function(){if($("body").data("is-mobile")){filtro.fechaFiltro()}},setZero:function(){$.smoothScroll({offset:0,direction:"top",scrollTarget:null,autoFocus:false,delegateSelector:null,beforeScroll:function(){},afterScroll:function(){},easing:"swing",speed:400,autoCoefficient:2,preventDefault:true})},abreFiltro:function(){$(".c-shop-filter-search-1").removeClass("hide").addClass("show");setTimeout(function(){$(".c-quick-search .c-theme-link").trigger("click");filtro.setZero()},300)},fechaFiltro:function(){if($("body").data("is-mobile")){var d=window.location.href;console.log(d.indexOf("filtro_aberto"));if(d.indexOf("filtro_aberto")<0){if(window.innerWidth<992){$(".c-shop-filter-search-1").addClass("hide").removeClass("show")}}else{setTimeout(function(){$(".c-shop-filter-search-1").removeClass("hide").addClass("show")},500)}}},setTipo:function(){var d="";$.each(filtro.valores.tipo,function(g,f){d+=filtro.setItem(f,"tipo")});filtro.addItem(d,".tipos")},setLocalidade:function(){var d="";$.each(filtro.valores.cidade,function(g,f){d+=filtro.setItem(f,"localidade cidade")});$.each(filtro.valores.bairro,function(g,f){d+=filtro.setItem(f,"localidade bairro")});filtro.addItem(d,".localidades")},addItem:function(f,g,d){if(g===undefined){g=".localidades"}if(d===undefined){d=true}html="";if(!d){html+=$(g+" .itens").html()}html+=f;$(g+" .itens").html(html)},delItem:function(d,f){},setItem:function(f,d){if(d===undefined){d="localidade bairro"}tem=$("."+d+"."+f.id).length;if(!tem){return'<li class="'+d+" "+f.id+' c-margin-t-5" data-item="'+f.id+'" title="clique para remover '+(f.descricao!==undefined?f.descricao:f.text)+'"><div class="btn btn-azul-pow-reverso c-btn-uppercase c-btn-bold c-btn-border-2x btn-block"><span class="c-theme-link pull-left"> x </span>'+(f.descricao!==undefined?f.descricao:f.text)+"</div></li>"}return""},setSelectcidade:function(d,f){if(f===undefined){f=false}if(f){i=d.id;a=i.split(";");texto=d.text;t=texto.split("*");ba=t[2].split(",");item="";data={id:a[0],text:t[1]};item+=filtro.setItem(data,"localidade cidade");b=a[1].split(",");$.each(b,function(h,g){if(g!==""){data={id:g,text:ba[h]};item+=filtro.setItem(data,"localidade bairro")}});item=filtro.setItem(d,"localidade cidade")}else{item=filtro.setItem(d,"localidade cidade")}filtro.addItem(item,".localidades",false);pesquisa.getValores()},setSelectbairro:function(d,f){if(f===undefined){f=false}if(f){text=d.text;id=d.id;t=text.split("*");c=[];bi=id.indexOf(",")>=0?id.split(","):[id];bt=t[1].indexOf(",")>=0?t[1].split(","):[t[1]];item="";$.each(bi,function(h,g){if(g!==""){data={id:g,text:bt[h]};item+=filtro.setItem(data,"localidade bairro")}})}else{item=filtro.setItem(d,"localidade bairro")}filtro.addItem(item,".localidades",false);pesquisa.getValores()},setGeral:function(){},setElementos:function(d){$.each(this.elementos,function(g,f){if(f.campo_selecionado!==undefined){if(d[f.campo_selecionado]!==undefined){if(f.array){filtro.valores[g]=d[f.campo_selecionado][g]}else{filtro.valores[g]=d[f.campo_selecionado]}}}else{if(d[g]!==undefined){filtro.valores[g]=d[g]}}});return this},getElementos:function(){var d={};$.each(filtro.elementos,function(g,f){switch(f.tipo){case"li":console.log($("li"+f.campo));d[g]=[];$.each($("li"+f.campo),function(k,j){d[g][k]=$(this).data("item")});break;case"attr_active":d[g]=$(""+f.campo+".active").data("tipo");break;case"val":if($(f.campo).val()!==undefined&&$(f.campo).val()>0){d[g]=$(""+f.campo).val()}break;case"val_text":if($(f.campo).val()!==undefined){d[g]=$(""+f.campo).val()}break;case"check":if($(""+f.campo+":checked").length>0){d[g]=$(""+f.campo+":checked").length}break;case"url":d[g]=$("."+g+"").data("item");break;case"range":var h=[];$(f.campo+":checked").each(function(k,j){h.push($(j).val())});d[g]=h;break}});return d},valores:{},elementos:{id_empresa:{campo:".id_empresa",url:true,tipo:"li"},tipo_negocio:{campo:".tipo-negocio",url:true,tipo:"attr_active"},tipo:{campo:".tipo",url:true,tipo:"li",campo_selecionado:"tipo_selecionado",array:false},cidade:{campo:".localidade.cidade",url:true,tipo:"li",campo_selecionado:"localidade_selecionado",array:true},bairro:{campo:".localidade.bairro",url:true,tipo:"li",campo_selecionado:"localidade_selecionado",array:true},valor_min:{campo:".valor-min",url:false,tipo:"val"},valor_max:{campo:".valor-max",url:false,tipo:"val"},area_min:{campo:".area-min",url:false,tipo:"val"},area_max:{campo:".area-max",url:false,tipo:"val"},residencial:{campo:".residencial",url:false,tipo:"check"},condominio:{campo:".condominio",url:false,tipo:"check"},mobiliado:{campo:".mobiliado",url:false,tipo:"check"},comercial:{campo:".comercial",url:false,tipo:"check"},quartos:{campo:".quartos",url:true,tipo:"range"},banheiros:{campo:".banheiros",url:false,tipo:"range"},vagas:{campo:".vagas",url:false,tipo:"range"},lista_tipo:{campo:".lista-tipo",url:false,tipo:"attr_active"},ordem:{campo:".ordem",url:false,tipo:"val_text"},}};$(function(){$(".item-vertical .carousel").swiperight(function(){$(this).carousel("prev");fotos.set_images($(this),"prev")});$(".item-vertical .carousel").swipeleft(function(){$(this).carousel("next");fotos.set_images($(this),"next")});$(".item-grid .carousel").swiperight(function(){$(this).carousel("prev");fotos.set_images($(this),"prev")});$(".item-grid .carousel").swipeleft(function(){$(this).carousel("next");fotos.set_images($(this),"next")})});